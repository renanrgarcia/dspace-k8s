<?xml version="1.0" encoding="UTF-8" ?>
<schema name="dspace-search" version="1.6">
  <!-- DSpace Search Schema -->

  <!-- Field Type Definitions -->
  <fieldType
    name="string"
    class="solr.StrField"
    sortMissingLast="true"
    docValues="true"
  />
  <fieldType
    name="boolean"
    class="solr.BoolField"
    sortMissingLast="true"
    docValues="true"
  />
  <fieldType
    name="int"
    class="solr.TrieIntField"
    precisionStep="0"
    positionIncrementGap="0"
    docValues="true"
  />
  <fieldType
    name="long"
    class="solr.TrieLongField"
    precisionStep="0"
    positionIncrementGap="0"
    docValues="true"
  />
  <fieldType
    name="float"
    class="solr.TrieFloatField"
    precisionStep="0"
    positionIncrementGap="0"
    docValues="true"
  />
  <fieldType
    name="double"
    class="solr.TrieDoubleField"
    precisionStep="0"
    positionIncrementGap="0"
    docValues="true"
  />
  <fieldType
    name="date"
    class="solr.TrieDateField"
    precisionStep="0"
    positionIncrementGap="0"
    docValues="true"
  />

  <!-- Text Field Types -->
  <fieldType
    name="text_general"
    class="solr.TextField"
    positionIncrementGap="100"
  >
    <analyzer type="index">
      <tokenizer class="solr.StandardTokenizerFactory" />
      <filter
        class="solr.StopFilterFactory"
        ignoreCase="true"
        words="stopwords.txt"
        enablePositionIncrements="true"
      />
      <filter class="solr.LowerCaseFilterFactory" />
      <filter class="solr.SnowballPorterFilterFactory" language="English" />
    </analyzer>
    <analyzer type="query">
      <tokenizer class="solr.StandardTokenizerFactory" />
      <filter
        class="solr.StopFilterFactory"
        ignoreCase="true"
        words="stopwords.txt"
        enablePositionIncrements="true"
      />
      <filter
        class="solr.SynonymGraphFilterFactory"
        synonyms="synonyms.txt"
        ignoreCase="true"
        expand="true"
      />
      <filter class="solr.LowerCaseFilterFactory" />
      <filter class="solr.SnowballPorterFilterFactory" language="English" />
    </analyzer>
  </fieldType>

  <fieldType name="text_ws" class="solr.TextField" positionIncrementGap="100">
    <analyzer>
      <tokenizer class="solr.WhitespaceTokenizerFactory" />
    </analyzer>
  </fieldType>

  <fieldType
    name="textSpell"
    class="solr.TextField"
    positionIncrementGap="100"
    autoGeneratePhraseQueries="true"
  >
    <analyzer>
      <tokenizer class="solr.StandardTokenizerFactory" />
      <filter
        class="solr.StopFilterFactory"
        ignoreCase="true"
        words="stopwords.txt"
        enablePositionIncrements="true"
      />
      <filter class="solr.LowerCaseFilterFactory" />
      <filter class="solr.RemoveDuplicatesTokenFilterFactory" />
    </analyzer>
  </fieldType>

  <fieldType
    name="textSuggest"
    class="solr.TextField"
    positionIncrementGap="100"
    autoGeneratePhraseQueries="true"
  >
    <analyzer>
      <tokenizer class="solr.StandardTokenizerFactory" />
      <filter class="solr.LowerCaseFilterFactory" />
      <filter class="solr.RemoveDuplicatesTokenFilterFactory" />
    </analyzer>
  </fieldType>

  <!-- DSpace Specific Field Types -->
  <fieldType
    name="handle"
    class="solr.StrField"
    sortMissingLast="true"
    docValues="true"
  />
  <fieldType
    name="uuid"
    class="solr.StrField"
    sortMissingLast="true"
    docValues="true"
  />
  <fieldType
    name="dc_identifier"
    class="solr.StrField"
    sortMissingLast="true"
    docValues="true"
  />

  <!-- Field Definitions -->
  <!-- Core DSpace Fields -->
  <field
    name="id"
    type="string"
    indexed="true"
    stored="true"
    required="true"
    multiValued="false"
  />
  <field
    name="handle"
    type="handle"
    indexed="true"
    stored="true"
    multiValued="false"
  />
  <field
    name="uuid"
    type="uuid"
    indexed="true"
    stored="true"
    multiValued="false"
  />
  <field
    name="type"
    type="string"
    indexed="true"
    stored="true"
    multiValued="false"
  />
  <field
    name="archived"
    type="boolean"
    indexed="true"
    stored="true"
    multiValued="false"
  />
  <field
    name="withdrawn"
    type="boolean"
    indexed="true"
    stored="true"
    multiValued="false"
  />
  <field
    name="discoverable"
    type="boolean"
    indexed="true"
    stored="true"
    multiValued="false"
  />

  <!-- Dublin Core Metadata Fields -->
  <field
    name="dc_title"
    type="text_general"
    indexed="true"
    stored="true"
    multiValued="true"
  />
  <field
    name="dc_title_sort"
    type="string"
    indexed="true"
    stored="true"
    multiValued="false"
  />
  <field
    name="dc_creator"
    type="text_general"
    indexed="true"
    stored="true"
    multiValued="true"
  />
  <field
    name="dc_creator_sort"
    type="string"
    indexed="true"
    stored="true"
    multiValued="false"
  />
  <field
    name="dc_subject"
    type="text_general"
    indexed="true"
    stored="true"
    multiValued="true"
  />
  <field
    name="dc_description"
    type="text_general"
    indexed="true"
    stored="true"
    multiValued="true"
  />
  <field
    name="dc_publisher"
    type="text_general"
    indexed="true"
    stored="true"
    multiValued="true"
  />
  <field
    name="dc_contributor"
    type="text_general"
    indexed="true"
    stored="true"
    multiValued="true"
  />
  <field
    name="dc_date"
    type="date"
    indexed="true"
    stored="true"
    multiValued="true"
  />
  <field
    name="dc_type"
    type="text_general"
    indexed="true"
    stored="true"
    multiValued="true"
  />
  <field
    name="dc_format"
    type="text_general"
    indexed="true"
    stored="true"
    multiValued="true"
  />
  <field
    name="dc_identifier"
    type="dc_identifier"
    indexed="true"
    stored="true"
    multiValued="true"
  />
  <field
    name="dc_source"
    type="text_general"
    indexed="true"
    stored="true"
    multiValued="true"
  />
  <field
    name="dc_language"
    type="text_general"
    indexed="true"
    stored="true"
    multiValued="true"
  />
  <field
    name="dc_relation"
    type="text_general"
    indexed="true"
    stored="true"
    multiValued="true"
  />
  <field
    name="dc_coverage"
    type="text_general"
    indexed="true"
    stored="true"
    multiValued="true"
  />
  <field
    name="dc_rights"
    type="text_general"
    indexed="true"
    stored="true"
    multiValued="true"
  />

  <!-- Collection and Community Fields -->
  <field
    name="collection"
    type="string"
    indexed="true"
    stored="true"
    multiValued="true"
  />
  <field
    name="community"
    type="string"
    indexed="true"
    stored="true"
    multiValued="true"
  />
  <field
    name="collection_name"
    type="text_general"
    indexed="true"
    stored="true"
    multiValued="true"
  />
  <field
    name="community_name"
    type="text_general"
    indexed="true"
    stored="true"
    multiValued="true"
  />

  <!-- Bitstream Fields -->
  <field
    name="bitstream"
    type="string"
    indexed="true"
    stored="true"
    multiValued="true"
  />
  <field
    name="bitstream_name"
    type="text_general"
    indexed="true"
    stored="true"
    multiValued="true"
  />
  <field
    name="bitstream_format"
    type="text_general"
    indexed="true"
    stored="true"
    multiValued="true"
  />
  <field
    name="bitstream_size"
    type="long"
    indexed="true"
    stored="true"
    multiValued="false"
  />

  <!-- Full Text Search -->
  <field
    name="fulltext"
    type="text_general"
    indexed="true"
    stored="false"
    multiValued="true"
  />

  <!-- Suggest Field -->
  <field
    name="suggest"
    type="textSuggest"
    indexed="true"
    stored="true"
    multiValued="true"
  />
  <field
    name="suggest_weight"
    type="int"
    indexed="true"
    stored="true"
    multiValued="false"
  />

  <!-- Text Field for General Search -->
  <field
    name="text"
    type="text_general"
    indexed="true"
    stored="false"
    multiValued="true"
  />

  <!-- Copy Fields for Search -->
  <copyField source="dc_title" dest="text" />
  <copyField source="dc_creator" dest="text" />
  <copyField source="dc_subject" dest="text" />
  <copyField source="dc_description" dest="text" />
  <copyField source="dc_publisher" dest="text" />
  <copyField source="dc_contributor" dest="text" />
  <copyField source="dc_type" dest="text" />
  <copyField source="dc_format" dest="text" />
  <copyField source="dc_source" dest="text" />
  <copyField source="dc_language" dest="text" />
  <copyField source="dc_relation" dest="text" />
  <copyField source="dc_coverage" dest="text" />
  <copyField source="dc_rights" dest="text" />
  <copyField source="collection_name" dest="text" />
  <copyField source="community_name" dest="text" />
  <copyField source="bitstream_name" dest="text" />
  <copyField source="fulltext" dest="text" />

  <!-- Dynamic Fields -->
  <dynamicField
    name="*_txt"
    type="text_general"
    indexed="true"
    stored="true"
    multiValued="true"
  />
  <dynamicField
    name="*_str"
    type="string"
    indexed="true"
    stored="true"
    multiValued="true"
  />
  <dynamicField
    name="*_int"
    type="int"
    indexed="true"
    stored="true"
    multiValued="true"
  />
  <dynamicField
    name="*_long"
    type="long"
    indexed="true"
    stored="true"
    multiValued="true"
  />
  <dynamicField
    name="*_float"
    type="float"
    indexed="true"
    stored="true"
    multiValued="true"
  />
  <dynamicField
    name="*_double"
    type="double"
    indexed="true"
    stored="true"
    multiValued="true"
  />
  <dynamicField
    name="*_date"
    type="date"
    indexed="true"
    stored="true"
    multiValued="true"
  />
  <dynamicField
    name="*_bool"
    type="boolean"
    indexed="true"
    stored="true"
    multiValued="true"
  />

  <!-- Unique Key -->
  <uniqueKey>id</uniqueKey>

  <!-- Similarity -->
  <similarity class="org.apache.lucene.search.similarities.BM25Similarity" />
</schema>
